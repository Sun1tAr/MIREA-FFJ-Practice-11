# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–Ω—è—Ç–∏–µ ‚Ññ11: JWT –¢–æ–∫–µ–Ω—ã –≤ REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–º–µ—Ç–∫–∞–º–∏

## –í—ã–ø–æ–ª–Ω–∏–ª: –¢—É–µ–≤ –î. –≠–§–ú–û-01-25

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

REST API —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–º–µ—Ç–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π JWT (JSON Web Tokens) –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–º–µ—Ç–∫–∞–º–∏ (CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏) —Å –∑–∞—â–∏—Ç–æ–π —á–µ—Ä–µ–∑ Bearer token. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è, –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è, –ø–æ–ª—É—á–∞—Ç—å access –∏ refresh —Ç–æ–∫–µ–Ω—ã, –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º–∏ –∑–∞–º–µ—Ç–∫–∞–º–∏. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏–µ refresh token –≤ Redis —Å TTL, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–µ—Å—Å–∏–∏.

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- **Spring Boot 3.5.7** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Spring Web** ‚Äî –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ REST API
- **Spring Security** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- **Spring Data JPA** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PostgreSQL —á–µ—Ä–µ–∑ Hibernate
- **Spring Data Redis** ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ refresh token —Å TTL
- **Spring Validation** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **PostgreSQL** ‚Äî —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∑–∞–º–µ—Ç–æ–∫
- **Redis** ‚Äî in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è refresh —Ç–æ–∫–µ–Ω–æ–≤
- **JJWT 0.12.3** ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å JWT —Ç–æ–∫–µ–Ω–∞–º–∏
- **BCrypt** ‚Äî —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **H2 Database** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ë–î –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **Lombok** ‚Äî —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
- **Maven** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
- **Java 17** ‚Äî —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–õ–µ–≥–µ–Ω–¥–∞:** üîì –û—Ç–∫—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø ¬∑ üîí –¢—Ä–µ–±—É–µ—Ç—Å—è ACCESS token ¬∑ üõ°Ô∏è –¢–æ–ª—å–∫–æ USER/ADMIN

### API v1 (Authentication & Notes Management)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –î–µ–π—Å—Ç–≤–∏–µ | –û—Ç–≤–µ—Ç | –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è | –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ |
|-------|----------|-----------|----------|-------|-----------|-------------|
| üîì **POST** | `/auth/register` | - | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | `201 CREATED` | –ù–µ—Ç | `AuthResponse` —Å ACCESS –∏ REFRESH token |
| üîì **POST** | `/auth/login` | - | –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É | `200 OK` | –ù–µ—Ç | `AuthResponse` —Å ACCESS –∏ REFRESH token |
| üîí **POST** | `/auth/logout` | - | –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã | `200 OK` | ACCESS token | `AuthResponse` |
| üîì **POST** | `/auth/refresh` | - | –û–±–Ω–æ–≤–∏—Ç—å ACCESS token | `200 OK` | REFRESH token –≤ —Ç–µ–ª–µ | `AuthResponse` (–Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã) |
| üîì **GET** | `/api/v1/notes/health` | - | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞ | `200 OK` | –ù–µ—Ç | `{"status":"ok"}` |
| üîí **POST** | `/api/v1/notes/` | - | –°–æ–∑–¥–∞—Ç—å –∑–∞–º–µ—Ç–∫—É | `201 CREATED` | ACCESS token | `NoteDTO` |
| üîí **GET** | `/api/v1/notes/` | - | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–º–µ—Ç–∫–∏ | `200 OK` | ACCESS token | –°–ø–∏—Å–æ–∫ `NoteDTO` |
| üîí **GET** | `/api/v1/notes/{id}` | `id` | –ü–æ–ª—É—á–∏—Ç—å –∑–∞–º–µ—Ç–∫—É –ø–æ ID | `200 OK` | ACCESS token | `NoteDTO` |
| üîí **PUT** | `/api/v1/notes/{id}` | `id` | –ó–∞–º–µ–Ω–∏—Ç—å –∑–∞–º–µ—Ç–∫—É –ø–æ–ª–Ω–æ—Å—Ç—å—é | `200 OK` | ACCESS token | `NoteDTO` |
| üîí **PATCH** | `/api/v1/notes/{id}` | `id` | –ß–∞—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É | `200 OK` | ACCESS token | `NoteDTO` |
| üîí **DELETE** | `/api/v1/notes/{id}` | `id` | –£–¥–∞–ª–∏—Ç—å –∑–∞–º–µ—Ç–∫—É | `200 OK` | ACCESS token | - |

## –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (POST /auth/register, POST /auth/login)

```json
{
  "email": "user@example.com",
  "password": "securePassword123"
}
```

### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (POST /api/v1/notes/)

```json
{
  "title": "My First Note",
  "content": "This is my first note content"
}
```

### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (PUT /api/v1/notes/{id})

```json
{
  "title": "Updated Title",
  "content": "Updated content here"
}
```

### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (PATCH /api/v1/notes/{id})

```json
{
  "fields": {
    "title": "Only Title Updated",
    "content": "Or only content"
  }
}
```

### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (POST /auth/refresh)

```json
{
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

### –û—Ç–≤–µ—Ç (POST /auth/register, POST /auth/login, POST /auth/refresh)

```json
{
  "tokens": [
    {
      "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
      "tokenType": "ACCESS_BEARER",
      "issuedAt": "2025-12-14T20:15:00Z",
      "expiresAt": "2025-12-14T21:15:00Z"
    },
    {
      "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
      "tokenType": "REFRESH_BEARER",
      "issuedAt": "2025-12-14T20:15:00Z",
      "expiresAt": "2026-01-13T20:15:00Z"
    }
  ]
}
```

### –û—Ç–≤–µ—Ç (POST /api/v1/notes/, GET /api/v1/notes/{id}, PUT /api/v1/notes/{id}, PATCH /api/v1/notes/{id})

```json
{
  "id": 1,
  "title": "My First Note",
  "content": "This is my first note content",
  "createdAt": "2025-12-14T20:15:00Z",
  "updatedAt": "2025-12-14T20:15:00Z"
}
```

### –û—Ç–≤–µ—Ç (GET /api/v1/notes/)

```json
[
  {
    "id": 1,
    "title": "First Note",
    "content": "Content 1",
    "createdAt": "2025-12-14T20:10:00Z",
    "updatedAt": "2025-12-14T20:10:00Z"
  },
  {
    "id": 2,
    "title": "Second Note",
    "content": "Content 2",
    "createdAt": "2025-12-14T20:12:00Z",
    "updatedAt": "2025-12-14T20:12:00Z"
  }
]
```

### –ó–∞–≥–æ–ª–æ–≤–æ–∫ (–¥–ª—è –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)

```
Authorization: Bearer <ACCESS_TOKEN>
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
my/learn/mireaffjpractice11/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ EncodingConfig.java                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è BCrypt –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ JwtConfig.java                          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è JWT (secret, lifetime)
‚îÇ   ‚îú‚îÄ‚îÄ RedisConfig.java                        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Redis –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ SecurityConfig.java                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Spring Security
‚îú‚îÄ‚îÄ controller/
‚îÇ   ‚îú‚îÄ‚îÄ AuthController.java                     # Interface –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ HealthController.java                   # Interface –¥–ª—è health check
‚îÇ   ‚îú‚îÄ‚îÄ NoteController.java                     # Interface –¥–ª—è –∑–∞–º–µ—Ç–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ filter/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ JwtRequestFilter.java               # –§–∏–ª—å—Ç—Ä –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ impl/
‚îÇ       ‚îú‚îÄ‚îÄ AuthControllerImpl.java              # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ       ‚îî‚îÄ‚îÄ NoteControllerImplV1.java           # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–º–µ—Ç–æ–∫ v1
‚îú‚îÄ‚îÄ DTO/
‚îÇ   ‚îú‚îÄ‚îÄ request/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreateNoteRequest.java              # DTO –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–º–µ—Ç–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginUserRequest.java               # DTO –¥–ª—è –ª–æ–≥–∏–Ω–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PatchNoteRequest.java               # DTO –¥–ª—è PATCH –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PutNoteRequest.java                 # DTO –¥–ª—è PUT –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RefreshTokenRequest.java            # DTO –¥–ª—è refresh token
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ RegisterUserRequest.java            # DTO –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ response/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthResponse.java                   # DTO –æ—Ç–≤–µ—Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NoteDTO.java                        # DTO –∑–∞–º–µ—Ç–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ServerStatusResponse.java           # DTO —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ service/
‚îÇ       ‚îî‚îÄ‚îÄ JWTokenOwner.java                   # DTO –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ JWT
‚îú‚îÄ‚îÄ entity/
‚îÇ   ‚îú‚îÄ‚îÄ Note.java                               # JPA Entity –∑–∞–º–µ—Ç–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ User.java                               # JPA Entity –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îî‚îÄ‚îÄ UserAuth.java                           # JPA Entity –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (UserDetails)
‚îú‚îÄ‚îÄ exception/
‚îÇ   ‚îú‚îÄ‚îÄ AppException.java                       # –ë–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ ConflictException.java                  # 409 Conflict
‚îÇ   ‚îú‚îÄ‚îÄ InternalServerException.java            # 500 Internal Server Error
‚îÇ   ‚îú‚îÄ‚îÄ JWTException.java                       # 401 JWT errors
‚îÇ   ‚îú‚îÄ‚îÄ NotFoundException.java                  # 404 Not Found
‚îÇ   ‚îú‚îÄ‚îÄ RawAppException.java                    # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ UnauthorizedException.java              # 401 Unauthorized
‚îÇ   ‚îî‚îÄ‚îÄ handler/
‚îÇ       ‚îî‚îÄ‚îÄ GeneralExceptionHandler.java        # –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îú‚îÄ‚îÄ JWToken.java                            # POJO —Ç–æ–∫–µ–Ω–∞ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ TokenType.java                          # Enum: ACCESS_BEARER –∏–ª–∏ REFRESH_BEARER
‚îÇ   ‚îî‚îÄ‚îÄ UserRole.java                           # Enum —Ä–æ–ª–µ–π (USER, ADMIN)
‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îú‚îÄ‚îÄ AuthRepository.java                     # JPA —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è UserAuth
‚îÇ   ‚îî‚îÄ‚îÄ NoteRepository.java                     # JPA —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è Note
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îú‚îÄ‚îÄ AuthService.java                        # Interface —Å–µ—Ä–≤–∏—Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ JWTService.java                         # Interface —Å–µ—Ä–≤–∏—Å–∞ JWT
‚îÇ   ‚îú‚îÄ‚îÄ NoteService.java                        # Interface —Å–µ—Ä–≤–∏—Å–∞ –∑–∞–º–µ—Ç–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ impl/
‚îÇ       ‚îú‚îÄ‚îÄ AuthServiceImpl.java                 # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ JWTServiceImpl.java                  # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è JWT (–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è)
‚îÇ       ‚îî‚îÄ‚îÄ NoteServiceV1Impl.java              # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–º–µ—Ç–æ–∫
‚îú‚îÄ‚îÄ util/
‚îÇ   ‚îú‚îÄ‚îÄ JwtUtils.java                           # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å JWT (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø–∞—Ä—Å–∏–Ω–≥)
‚îÇ   ‚îî‚îÄ‚îÄ NoteMapper.java                         # –ú–∞–ø–ø–µ—Ä Note ‚Üí NoteDTO
‚îî‚îÄ‚îÄ MireaFfjPractice11Application.java          # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [Postman –∫–æ–ª–ª–µ–∫—Ü–∏—é](https://www.postman.com/lively-flare-564043/workspace/learning/collection/42992055-b1282b40-96e0-4fd9-acce-13b93c2f7677?action=share&creator=42992055)

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–∞

| –ö–æ–¥ | –ù–∞–∑–≤–∞–Ω–∏–µ | –ì–¥–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è | –ß—Ç–æ –∑–Ω–∞—á–∏—Ç / –∫–æ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è |
| :-- | :-- | :-- | :-- |
| 200 | OK | –í—Å–µ —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ | –£—Å–ø–µ—à–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è. |
| 201 | Created | `/auth/register`, `/api/v1/notes/` | –†–µ—Å—É—Ä—Å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω. |
| 400 | Bad Request | `/auth/register`, `/auth/login`, `/api/v1/notes/*` | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (email, –ø–∞—Ä–æ–ª—å < 5 —Å–∏–º–≤–æ–ª–æ–≤, –ø—É—Å—Ç–æ–µ –ø–æ–ª–µ). |
| 401 | Unauthorized | –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JWT | –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç/–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π token. |
| 404 | Not Found | `/api/v1/notes/{id}` | –ó–∞–º–µ—Ç–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. |
| 409 | Conflict | `/auth/register`, `/api/v1/notes/*` | Email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –æ—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞. |
| 500 | Internal Server Error | `GeneralExceptionHandler` | –ù–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. |

### –¢–µ—Å—Ç –∫–µ–π—Å—ã

| ‚Ññ | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ú–∞—Ä—à—Ä—É—Ç | –ó–∞–ø—Ä–æ—Å (–ø—Ä–∏–º–µ—Ä) | –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç |
|--|--|--|--|--|
| 1 | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | **POST /auth/register** | `{"email":"john@example.com","password":"Pass123"}` | 201 Created + ACCESS –∏ REFRESH token |
| 2 | –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É | **POST /auth/login** | `{"email":"john@example.com","password":"Pass123"}` | 200 OK + ACCESS –∏ REFRESH token |
| 3 | –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏ | **POST /api/v1/notes/** | `{"title":"My Note","content":"Content"}` + Header: Bearer token | 201 Created + NoteDTO |
| 4 | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–º–µ—Ç–∫–∏ | **GET /api/v1/notes/** | Header: Bearer token | 200 OK + —Å–ø–∏—Å–æ–∫ NoteDTO |
| 5 | –ü–æ–ª—É—á–∏—Ç—å –∑–∞–º–µ—Ç–∫—É –ø–æ ID | **GET /api/v1/notes/1** | Header: Bearer token | 200 OK + NoteDTO |
| 6 | –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É (PUT) | **PUT /api/v1/notes/1** | `{"title":"New","content":"New"}` + Header: Bearer token | 200 OK + –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π NoteDTO |
| 7 | –ß–∞—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É (PATCH) | **PATCH /api/v1/notes/1** | `{"fields":{"title":"Updated"}}` + Header: Bearer token | 200 OK + –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π NoteDTO |
| 8 | –£–¥–∞–ª–∏—Ç—å –∑–∞–º–µ—Ç–∫—É | **DELETE /api/v1/notes/1** | Header: Bearer token | 200 OK |
| 9 | –û–±–Ω–æ–≤–∏—Ç—å ACCESS token —á–µ—Ä–µ–∑ REFRESH | **POST /auth/refresh** | `{"refreshToken":"<REFRESH_TOKEN>"}` | 200 OK + –Ω–æ–≤—ã–µ ACCESS –∏ REFRESH |
| 10 | –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã | **POST /auth/logout** | Header: Bearer token | 200 OK |
| 11 | Health check —Å–µ—Ä–≤–µ—Ä–∞ | **GET /api/v1/notes/health** | - | 200 OK + `{"status":"ok"}` |

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

![img.png](about/img.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 201 Created**, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã ACCESS –∏ REFRESH —Ç–æ–∫–µ–Ω—ã.

#### 2. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

![img_1.png](about/img_1.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω, –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã ACCESS –∏ REFRESH —Ç–æ–∫–µ–Ω—ã.

#### 3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏

![img_2.png](about/img_2.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 201 Created**, –∑–∞–º–µ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º createdAt –∏ updatedAt.

#### 4. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–º–µ—Ç–∫–∏

![img_3.png](about/img_3.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, –≤–æ–∑–≤—Ä–∞—â–µ–Ω —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–º–µ—Ç–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### 5. –ü–æ–ª—É—á–∏—Ç—å –∑–∞–º–µ—Ç–∫—É –ø–æ ID

![img_4.png](about/img_4.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–º–µ—Ç–∫–µ.

#### 6. –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É (PUT)

![img_5.png](about/img_5.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, –∑–∞–º–µ—Ç–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–µ–Ω–∞, –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ–ª—è, –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π updatedAt.

#### 7. –ß–∞—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É (PATCH)

![img_6.png](about/img_6.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–ª–∏—Å—å –Ω–µ–∏–∑–º–µ–Ω–Ω—ã.

#### 8. –£–¥–∞–ª–∏—Ç—å –∑–∞–º–µ—Ç–∫—É

![img_7.png](about/img_7.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, –∑–∞–º–µ—Ç–∫–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –ë–î.

#### 9. –û–±–Ω–æ–≤–∏—Ç—å ACCESS token —á–µ—Ä–µ–∑ REFRESH

![img_8.png](about/img_8.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, –≤—ã–¥–∞–Ω—ã –Ω–æ–≤—ã–µ ACCESS –∏ REFRESH —Ç–æ–∫–µ–Ω—ã, —Å—Ç–∞—Ä—ã–π REFRESH —É–¥–∞–ª–µ–Ω –∏–∑ Redis.

#### 10. –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã

![img_9.png](about/img_9.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, REFRESH token —É–¥–∞–ª–µ–Ω –∏–∑ Redis, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–ª–æ–≥–∏–Ω–µ–Ω.

#### 11. Health check —Å–µ—Ä–≤–µ—Ä–∞

![img_10.png](about/img_10.png)

–†–µ–∑—É–ª—å—Ç–∞—Ç: **HTTP 200 OK**, —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç —Å —Å—Ç–∞—Ç—É—Å–æ–º "ok".

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ `application.properties` –∏–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------------|----------|----------|
| REDIS_HOST | –•–æ—Å—Ç Redis —Å–µ—Ä–≤–µ—Ä–∞ | localhost |
| REDIS_PORT | –ü–æ—Ä—Ç Redis —Å–µ—Ä–≤–µ—Ä–∞ | 6379 |
| REDIS_PASSWORD | –ü–∞—Ä–æ–ª—å Redis (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è) | password |
| DB_URL | URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL | jdbc:postgresql://localhost:5432/practice11_db |
| DB_USER | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î | postgres |
| DB_PASSWORD | –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î | password |

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ application.properties:**
```properties
spring.redis.host=${REDIS_HOST}
spring.redis.port=${REDIS_PORT}
spring.redis.password=${REDIS_PASSWORD}
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASSWORD}
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã

#### JWT (JSON Web Token) —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

JWT —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä—ë—Ö —á–∞—Å—Ç–µ–π, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç–æ—á–∫–∞–º–∏:

```
header.payload.signature
```

- **Header** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∏–ø–µ —Ç–æ–∫–µ–Ω–∞ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–µ –ø–æ–¥–ø–∏—Å–∏ (HS256)
- **Payload** ‚Äî —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (claims) —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (username, authorities, userId, etc.)
- **Signature** ‚Äî –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø–æ–¥–ø–∏—Å—å –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–º–µ—Ä –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ JWT:**
```json
// Header
{
  "alg": "HS256",
  "typ": "JWT"
}

// Payload
{
  "sub": "john@example.com",
  "sid": 1,
  "iat": 1702576500,
  "exp": 1702580100,
  "ath": ["USER"],
  "type": "ACCESS_BEARER"
}
```

#### Access Token vs Refresh Token

- **Access Token** ‚Äî –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π (1 —á–∞—Å), —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ —Ä–æ–ª—è—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º
- **Refresh Token** ‚Äî –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π (30 –¥–Ω–µ–π), —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Redis), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ Access Token

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è:**
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –µ—Å–ª–∏ Access Token —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω, –æ–Ω –¥–µ–π—Å—Ç–≤—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
- –ö–æ–Ω—Ç—Ä–æ–ª—å: –º–æ–∂–Ω–æ –æ—Ç–æ–∑–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ —É–¥–∞–ª–µ–Ω–∏–µ Refresh Token –∏–∑ Redis
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å logout, —Å–º–µ–Ω—É –ø–∞—Ä–æ–ª—è —Å –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

#### Redis –¥–ª—è Refresh Token

Redis –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è Refresh Token —Å TTL:
- O(1) –¥–æ—Å—Ç—É–ø ‚Äî –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
- TTL –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Äî –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î

#### JwtRequestFilter –∏ Security Context

JwtRequestFilter ‚Äî —Ñ–∏–ª—å—Ç—Ä Spring Security, –∫–æ—Ç–æ—Ä—ã–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:
1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç JWT –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization: Bearer <TOKEN>`
2. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å—å –∏ –≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è
3. –ò–∑–≤–ª–µ–∫–∞–µ—Ç username –∏ —Ä–æ–ª–∏ –∏–∑ payload
4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Authentication –≤ SecurityContext
5. –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–∏–º —Ñ–∏–ª—å—Ç—Ä–∞–º/–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

#### 1. –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JWT –≤–º–µ—Å—Ç–æ session-based –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏?

**JWT –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- **Stateless** ‚Äî —Å–µ—Ä–≤–µ—Ä –Ω–µ —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ—Å—Å–∏–∏ (–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å)
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
- **CORS-friendly** ‚Äî –ª–µ–≥–∫–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ Headers –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π same-origin policy
- **Mobile-friendly** ‚Äî –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ API
- **–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å** ‚Äî –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —Ç–æ–∫–µ–Ω–µ, –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç server state

#### 2. –ü–æ—á–µ–º—É REFRESH token —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Redis?

**–ü—Ä–∏—á–∏–Ω—ã:**
- **–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø** ‚Äî O(1) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ vs O(n) –¥–ª—è –ë–î
- **TTL –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** ‚Äî Redis –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–ª—é—á–∏
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞** ‚Äî –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å –¥–ª—è logout/—Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ —É—Ç–µ—á–∫–∏

#### 3. –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å logout —Å JWT?

**–¢—Ä–∏ —Å–ø–æ—Å–æ–±–∞:**

1. **Blacklist (–¥–ª—è ACCESS token)** ‚Äî —Ö—Ä–∞–Ω–∏—Ç—å "–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ" —Ç–æ–∫–µ–Ω—ã –≤ Redis
2. **Refresh Token invalidation (v11)** ‚Äî —É–¥–∞–ª–∏—Ç—å REFRESH token –∏–∑ Redis ‚úì
3. **Short-lived tokens** ‚Äî ACCESS –±—ã—Å—Ç—Ä–æ –∏—Å—Ç–µ–∫–∞–µ—Ç, –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ logout

#### 4. –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å JWT –æ—Ç XSS –∞—Ç–∞–∫?

**–ú–µ—Ä—ã –∑–∞—â–∏—Ç—ã:**
- **HttpOnly Cookie** ‚Äî –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω JavaScript (–∑–∞—â–∏—Ç–∞ –æ—Ç XSS)
- **Secure Cookie** ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ HTTPS
- **SameSite Cookie** ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç CSRF
- **Short-lived token** ‚Äî –±—ã—Å—Ç—Ä–æ–µ –∏—Å—Ç–µ—á–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –æ–∫–Ω–æ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

#### 5. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç PATCH vs PUT?

- **PUT** ‚Äî –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—è–µ—Ç —Ä–µ—Å—É—Ä—Å (—Ç—Ä–µ–±—É–µ—Ç –≤—Å–µ –ø–æ–ª—è)
- **PATCH** ‚Äî –ß–∞—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å (–æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—è)

#### 6. –ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BCrypt –≤–º–µ—Å—Ç–æ MD5/SHA?

**BCrypt –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- **Slow** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω —á—Ç–æ–±—ã –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º (–∑–∞—â–∏—Ç–∞ –æ—Ç brute-force)
- **Salt** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–ª—å (–∑–∞—â–∏—Ç–∞ –æ—Ç rainbow tables)
- **Adaptive** ‚Äî –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏

#### 7. –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ACCESS token —á–µ—Ä–µ–∑ REFRESH?

```
1. Client —Ö—Ä–∞–Ω–∏—Ç ACCESS –∏ REFRESH —Ç–æ–∫–µ–Ω—ã
2. ACCESS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
3. ACCESS –∏—Å—Ç–µ–∫–∞–µ—Ç (401 –æ—à–∏–±–∫–∞)
4. Client –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç REFRESH –Ω–∞ /auth/refresh
5. Server –ø—Ä–æ–≤–µ—Ä—è–µ—Ç REFRESH –≤ Redis
6. Server –≤—ã–¥–∞–µ—Ç –Ω–æ–≤—ã–µ ACCESS –∏ REFRESH
7. Server —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–π REFRESH –∏–∑ Redis
8. Client –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–≤–æ–∏ —Ç–æ–∫–µ–Ω—ã
```

## –í—ã–≤–æ–¥—ã

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è ‚Ññ11 –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π REST API —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–º–µ—Ç–∫–∞–º–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç production-ready –ø–æ–¥—Ö–æ–¥ –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å–µ—Å—Å–∏–π.

**–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: ACCESS –∏ REFRESH —Ç–æ–∫–µ–Ω—ã —Å —Ä–∞–∑–Ω—ã–º–∏ TTL
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω JJWT 0.12.3 –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Refresh Token –≤ Redis —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º TTL
- –°–æ–∑–¥–∞–Ω JwtRequestFilter –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–º–µ—Ç–∫–∞–º–∏: CREATE, READ, UPDATE (PUT/PATCH), DELETE
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è logout —á–µ—Ä–µ–∑ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é Refresh Token
- –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º BCrypt
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (401, 403, 404, 409)
- –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Service, Repository, Controller, Filter, Exception layers
- Interface-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ (AuthController, NoteController)

**–ü—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏:**

- –†–∞–±–æ—Ç–∞ —Å JWT —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ JJWT –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π 0.12.3
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Access/Refresh Token –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ lifetime
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Redis –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞–Ω–∏–µ custom Spring Security —Ñ–∏–ª—å—Ç—Ä–æ–≤ (JwtRequestFilter)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ UserDetails –∏ Authentication –≤ SecurityContext
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π —Å BCrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å JPA Entity (Note, User, UserAuth)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å Jakarta Validation
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ REST API —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ HTTP —Å—Ç–∞—Ç—É—Å–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
